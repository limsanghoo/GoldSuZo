<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper
		PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
		"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="BoardMapper">
	
	<resultMap type="board" id="boardSelectMap">
		<result property="boardNo"	column="board_no"	jdbcType="VARCHAR"/>
		<result property="user.userNo"	column="user_no"	jdbcType="VARCHAR"/>
		<result property="user.profile"	column="profile"	jdbcType="VARCHAR"/>
		<result property="user.userNickname" column="user_nickname"	jdbcType="VARCHAR"/>
		<result	property="boardDetailText"	column="board_detail_text"	jdbcType="VARCHAR"/>
		<result	property="hashTag"	column="hash_tag"	jdbcType="VARCHAR"/>
		<result	property="userTheme"	column="user_theme"	jdbcType="VARCHAR"/>
		<result	property="boardRegDate"	column="board_reg_date"	jdbcType="DATE"/>
		<result	property="boardStatus"	column="board_status"	jdbcType="VARCHAR"/>
		<result	property="photo1"	column="photo1"	jdbcType="VARCHAR"/>
		<result	property="photo2"	column="photo2"	jdbcType="VARCHAR"/>
		<result	property="photo3"	column="photo3"	jdbcType="VARCHAR"/>
		<result	property="coord"	column="coord"	jdbcType="VARCHAR"/>
		<result	property="address"	column="address"	jdbcType="VARCHAR"/>
	</resultMap>
	
	
	 
	 <insert 	id="addBoard"	parameterType="board" >
	 	INSERT
		INTO board(board_no, user_no, board_detail_text, hash_tag, user_theme, board_reg_date, board_status, photo1, photo2, photo3, coord, address)
		VALUES('BD'||seq_bd.nextval,#{user.userNo},#{boardDetailText},#{hashTag:VARCHAR},#{userTheme},sysdate,#{boardStatus},#{photo1:VARCHAR},#{photo2:VARCHAR},#{photo3:VARCHAR},#{coord:VARCHAR},#{address:VARCHAR})
	 </insert>
	 
	 
	<select id="listBoard" parameterType="com.zagle.service.domain.SearchBoard" resultMap="boardSelectMap">
		SELECT DISTINCT u.user_no, u.profile, u.user_nickname, b.board_no, b.photo1, b.board_detail_text, b.hash_tag, b.user_theme, b.coord, b.board_reg_date, b.board_status
		FROM users u, board b
		WHERE u.user_no=b.user_no
		ORDER BY b.board_reg_date DESC
	 </select>
	 
	 
	<select id="getBoard" parameterType="int"	resultMap="boardSelectMap">
	 	SELECT *
	 	FROM board
	 	WHERE board_no=#{value}
	</select>


	<update id="updateBoard" parameterType="board">
		UPDATE board
		<set>
			board_detail_text=#{boardDetailText},
			hash_tag=#{hashTag:VARCHAR},
			user_theme=#{userTheme},
			board_status=#{boardStatus}
			photo1=#{photo1:VARCHAR},
			photo2=#{photo2:VARCHAR},
			photo3=#{photo3:VARCHAR},
			coord=#{coord:VARCHAR},
			address=#{address:VARCHAR}		
		</set>
		WHERE board_no=#{boardNo}
	</update>
	
	
	<update id="deleteBoard" parameterType="board">
		UPDATE board
		<set>
			board_status=#{boardStatus}
		</set>
		WHERE board_no=#{boardNo}
	</update>
	
	<select id="getMapList" parameterType="string" resultMap="boardSelectMap">
		select * from board where address like '${searchKeyword}%'
	</select>
	 
</mapper>